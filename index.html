
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>우리 매장 주변 키워드 장소 검색기</title>
  <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=b3aec68754d15e6e3d7a8f7e49246a76&libraries=services"></script>
  <style>
    #map { width: 100%; height: 400px; margin-bottom: 20px; }
    .container { padding: 20px; font-family: Arial, sans-serif; }
    input, button { padding: 8px; margin: 5px 0; width: 100%; max-width: 400px; }
    ul { list-style: none; padding: 0; }
    .section { margin-top: 20px; }
  </style>
</head>
<body>
  <div class="container">
    <h2>📍 우리 매장 주변 키워드 장소 검색</h2>

    <form onsubmit="searchByAddress(); return false;">
      <div>
        <label>매장 주소:</label><br>
        <input type="text" id="storeAddress" value="서울 용산구 이태원로 123">
      </div>
      <div>
        <label>키워드 목록 (쉼표로 구분):</label><br>
        <input type="text" id="keywords" value="카페,맛집,편의점,헬스장">
      </div>
      <button type="submit">검색 시작</button>
    </form>

    <div id="map"></div>

    <div class="section" id="results"></div>
  </div>

  <script>
    const map = new kakao.maps.Map(document.getElementById('map'), {
      center: new kakao.maps.LatLng(37.5665, 126.9780),
      level: 4
    });

    const ps = new kakao.maps.services.Places();
    const geocoder = new kakao.maps.services.Geocoder();
    const marker = new kakao.maps.Marker();
    marker.setMap(map);

    function searchByAddress() {
      const address = document.getElementById('storeAddress').value;
      const keywordStr = document.getElementById('keywords').value;
      const keywords = keywordStr.split(',').map(k => k.trim()).filter(k => k.length > 0);
      const resultsDiv = document.getElementById('results');
      resultsDiv.innerHTML = '';

      geocoder.addressSearch(address, function(result, status) {
        if (status === kakao.maps.services.Status.OK) {
          const coords = new kakao.maps.LatLng(result[0].y, result[0].x);
          map.setCenter(coords);
          marker.setPosition(coords);

          keywords.forEach(keyword => {
            ps.keywordSearch(keyword, (data, status) => {
              if (status === kakao.maps.services.Status.OK) {
                const section = `<h4>🔍 ${keyword}</h4><ul>` +
                  data.map(place => `<li>${place.place_name} - ${place.road_address_name || place.address_name}</li>`).join('') +
                  '</ul>';
                resultsDiv.innerHTML += section;
              } else {
                resultsDiv.innerHTML += `<h4>🔍 ${keyword}</h4><p>결과 없음</p>`;
              }
            }, {
              location: coords,
              radius: 1000
            });
          });
        } else {
          alert('주소를 찾을 수 없습니다.');
        }
      });
    }
  </script>
</body>
</html>
